import requests
from bs4 import BeautifulSoup
from googlesearch import search
from termcolor import colored
import os

def clear_screen():
    os.system('cls' if os.name == 'nt' else 'clear')

def display_ascii():
    print(colored("""
                                      ####################
                               ##############++--++##############
                          #########--------------------------#########
                       #######----------------++#+----------------#######
                    ######--------+###-------+-####------####--------+######
                 ######-----------+####-------##-#-------+###-----------+######
               ######--------------#+#----------+----------+------++##-----######
             #####+------####+-------#----------+#-------+---------+###------#####
            ####+------#++###+----------------+#-+-------#---------####+#------#####
          #####--------#+##+-----------##++-#+---+--+##--#+-----+----##+#--------#####
         ####----------##+##----##-----########+++--+####+---##-----##+##----------####
        ####--------------++#+--#+##------#-#############----+#---+#++--------------####
      ####------------------###-+-----------#-################---###-----------------####
     ####--------------------+#++-+#----------#+--#+#########-++##+-------------------+###
     ###-----------------------###+---####---++--------####+--###----------------------+###
    ###-------------------------+#+#+##################++++++-++------------------------+###
   ####--------------------------+######################++-+-+---------------------------####
  ####--------------------------+########################++++-----------------------------###
  ###---------------------------########################++++++-+--------------------------+###
  ###---------------------#####+#######################++##+--+++#####---------------------###
 ###+++++++++++++++++++++++##++##+++######################+----++++##+++++++++++++++++++++++###
 ###+++++++++++++++++++++++++++###--######################+---+#++++++++++++++++++++++++++++###
 ###+++++++++++++++++++++++++++###-###------######++----##++--++++++++++++++++++++++++++++++###
###+++++++++++++++++++++++++++++###+--------+#+#+--------------+++++++++++++++++++++++++++++###
################################+##+#++-----+###-+---------------##############################
################################++#++#+---++####+++------+#+++---##############################
####################################----++#####--++#+-++---+-+--+##############################
##############################################----#+++####---++-###############################
 ###-----------------------------+-###########----+---#####---------------------------------###
 ###-###-------------------------+++#-+######+---------##+----------------------------------###
 ###---#---------------------------+##-#########-------#+------------------------------####-###
  ##-####------------------------#####+###########+-####---+###------------------------###-###
  ###-###-----------------------###################+------++####+----------------------+-+-###
  ####-+----------------------####+-####+##########-----+++--+####--------------------###-####
   ###-+###------------------####----##############+-+-++------####------------------#+#-+###
   ####-###-----------------###------##############+##+#-+-------+##+---------------####-###
    ####-###+-------------+#+--------###################-----------+#+-------------####-####
     ####-##----------------------------###############--------------------------------####
      ####-##+#----------------------------######+#+-----------------------------####-####
       ####-+-##---------------------------------------------------------------##-##-####
        ####+##-##------------------------------------------------------------#-##-#####
         #####-####---------------------------------------------------------####+-####
           #####--#-++----------------------------------------------------###+--#####
             #####-#####------------------------------------------------+#-#--#####
              ######-#####------------------------------------------+##---#-#####
                 #####-####-##+-----------------------------------##-###-+#####
                   ######--##-###---------------------------+#-##+###--######
                     ########-###########--+---------##-###+##-#++-########
                        #########----####--##+#+#+##+###-##----########
                            ############-------+--+-----############
                                  ############################

                                     (CODE BY KADEZ-406)
                                  #THANKS FOR SUDATTACK CYBER TEAM
                                 #THAKS FOR CYBER SEDERHANA TEAM
    """, 'green'))

def single_site_check(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            print(colored("[+]", 'white'), colored(url, 'white'), colored("[VULN]", 'green'))
            with open("vuln.txt", "a") as file:
                file.write(url + "\n")
        else:
            print(colored("[+]", 'white'), colored(url, 'white'), colored("[NOT VULN]", 'red'))
            with open("not.txt", "a") as file:
                file.write(url + "\n")
    except Exception as e:
        print(colored(f"Request failed: {e}", 'red'))

def mass_site_check(file_path):
    try:
        with open(file_path, 'r') as file:
            urls = file.read().splitlines()
            for url in urls:
                single_site_check(url)
    except FileNotFoundError:
        print(colored("File tidak ditemukan.", 'red'))
    except Exception as e:
        print(colored(f"Error: {e}", 'red'))

def check_with_dork(query):
    try:
        num_urls = int(input("Masukkan jumlah URL yang ingin diambil: "))
        urls = search(query, num_results=num_urls)
        for url in urls:
            single_site_check(url)
    except ValueError:
        print(colored("Masukkan angka yang valid untuk jumlah URL.", 'red'))
    except Exception as e:
        print(colored(f"Error: {e}", 'red'))

def main():
    clear_screen()
    display_ascii()
    print("1. Single site check")
    print("2. Mass site check")
    print("3. Check with dork")
    print("4. Exit")
    choice = input("Pilih fitur yang ingin digunakan: ")

    if choice == "1":
        url = input("Masukkan URL: ")
        single_site_check(url)
    elif choice == "2":
        file_path = input("Masukkan nama file: ")
        mass_site_check(file_path)
    elif choice == "3":
        query = input("Masukkan query dork: ")
        check_with_dork(query)
    elif choice == "4":
        print("Terima kasih telah menggunakan tools ini. Sampai jumpa!")
        return
    else:
        print("Pilihan tidak valid.")

    input("\nTekan Enter untuk kembali ke menu utama...")
    main()

if __name__ == "__main__":
    main()
